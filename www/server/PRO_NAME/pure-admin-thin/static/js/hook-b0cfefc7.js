import{Y as y,k as o,v as B,O as Q,N as W,m as Y,aQ as q,ae as H,G as u,at as P,aR as J}from"./index-bd88d923.js";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang-ff054f51.js";import{h as C,a as Z}from"./game-c13a10d3.js";import{z as E}from"./index.esm-cdf23848.js";import"./index-8426971e.js";import"./hooks-142968e5.js";let S;function ie(d){const h=y({chatIPs:"",gameId:1}),x=o(),T=o([]),m=o([]),p=o(!0),I=o(0),b=y({total:0,pageSize:10,currentPage:1,background:!0}),_=y({newPwd:""}),M=o();o([]);const D=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"聊天节点IP",prop:"chatIPs",minWidth:130},{label:"操作",fixed:"right",width:180,slot:"operation"}],R=B(()=>["!h-[20px]","reset-margin","!text-gray-500","dark:!text-white","dark:hover:!text-primary"]);function k(t){}function A(t="新增",e){q({title:`${t}聊天节点IP`,props:{formInline:{title:t,channelAppId:(e==null?void 0:e.channelAppId)??0,channelType:(e==null?void 0:e.channelType)??"",appName:(e==null?void 0:e.appName)??0,appId:(e==null?void 0:e.appId)??"",appKey:(e==null?void 0:e.appKey)??"",serverKey:(e==null?void 0:e.serverKey)??"",notice:(e==null?void 0:e.notice)??[],user_policy_url:(e==null?void 0:e.user_policy_url)??"",privacy_policy_url:(e==null?void 0:e.privacy_policy_url)??"",payMentSwitch:(e==null?void 0:e.payMentSwitch)??!0,chatIPs:(e==null?void 0:e.chatIPs)??[]}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>H(X,{ref:x}),beforeSure:(a,{options:n})=>{const s=x.value.getRef(),c=n.props.formInline;function r(){P(`您${t}了渠道名为${c.appName}的这条数据`,{type:"success"}),a(),f(),i()}s.validate(l=>{l&&(t==="新增"?(O(c),r()):(e.channelAppId,r()))})}})}function g(t,e){for(let a=0;a<e.length;a++){const n=e[a];if(t===n.id)return a}return 0}function v(t){return t&&t.chatIPs?t.chatIPs:[]}function O(t){const e=u(S),a={chatIPs:t.chatIPs},n=g(h.gameId,e),s=String(a.chatIPs).split(","),r=u(v(e[n].info)).concat(s);e[n].chatIPs=u(r);const l={};l.autoOpenModel=e[n].info?e[n].info.autoOpenModel:!1,l.autoVal=e[n].info?e[n].info.autoVal:0,l.autoTime=e[n].info?e[n].info.autoTime:"",l.chatIPs=e[n].chatIPs,e[n].info=l,C(e[n]),setTimeout(()=>{f(),i()},800)}function w(t,e){}function G(t){const e=u(S),a=g(h.gameId,e),n=v(e[a].info);for(let c=0;c<n.length;c++)if(n[c]===t){n.splice(c,1);break}e[a].chatIPs=u(n);const s={};s.autoOpenModel=e[a].info?e[a].info.autoOpenModel:!1,s.autoVal=e[a].info?e[a].info.autoVal:0,s.autoTime=e[a].info?e[a].info.autoTime:"",s.chatIPs=e[a].chatIPs,e[a].info=s,C(e[a]),setTimeout(()=>{f(),i()},800)}function N(t){P(`您删除了渠道名为${t.name}的这条数据`,{type:"success"}),G(t.chatIPs),f(),i()}function $(t){}function z(t){}function F(t){I.value=t.length,d.value.setAdaptive()}function K(){I.value=0,d.value.getTableRef().clearSelection()}function L(){const t=d.value.getTableRef().getSelectionRows();P(`已删除服务器为 ${J(t,"id")} 的数据`,{type:"success"}),d.value.getTableRef().clearSelection()}async function i(){p.value=!0;const t=g(h.gameId,m.value),e=v(m.value[t].info),a=[];for(let n=0;n<e.length;n++){const s=e[n],c={};c.chatIPs=s,a.push(c)}T.value=u(a),setTimeout(()=>{p.value=!1},500)}async function f(){p.value=!0;const{data:t}=await Z();S=u(t),m.value=t,setTimeout(()=>{p.value=!1},500)}async function V(){}const U=t=>{t&&(t.resetFields(),f(),i())};Q(_,({newPwd:t})=>M.value=W(t)?-1:E(t).score);async function j(t){}return Y(()=>{f(),setTimeout(()=>{i()},500)}),{form:h,loading:p,columns:D,dataList:T,gameDataList:m,pagination:b,buttonClass:R,selectedNum:I,onSearch:V,onAddGame:A,onbatchDel:L,handleRole:j,resetForm:U,onChannelSearch:i,handleUpdate:k,handleDelete:N,handleSizeChange:$,onSelectionCancel:K,handleCurrentChange:z,handleSelectionChange:F}}export{ie as useUser};
