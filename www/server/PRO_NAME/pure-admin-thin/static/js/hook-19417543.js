import{Y as b,k as d,v as Q,O as J,N as K,m as V,aU as X,aQ as y,ae as C,at as o,aR as Z}from"./index-bd88d923.js";import{_ as w}from"./index.vue_vue_type_script_setup_true_lang-7160f302.js";import{_ as ee}from"./index_single.vue_vue_type_script_setup_true_lang-0cec5d8a.js";import{_ as ae}from"./index_common.vue_vue_type_script_setup_true_lang-7d992b54.js";import{b as te,u as ne,c as ie,e as se,g as le,h as ce,f as ue}from"./operations-67cacc8a.js";import{a as de}from"./game-c13a10d3.js";import{z as me}from"./index.esm-cdf23848.js";import{u as S,w as oe}from"./xlsx-f5126985.js";import"./index-8426971e.js";import"./rule-a57bb2c0.js";import"./hooks-6a2b754a.js";function Te(g){const i=b({id:0,gameId:1,codeName:"",emailId:0,len:5,universal:"0",repe:1,isuse:0,endTime:"",mailList:[],quantity:0,code:""}),f=d(),h=d([]),T=d([]),m=d([]),t=d(!0),r=d(0),N=b({total:0,pageSize:10,currentPage:1,background:!0}),_=b({newPwd:""}),x=d();d([]);const I=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"游戏ID",prop:"gameId",minWidth:130},{label:"infoID",prop:"id",minWidth:130},{label:"激活码名",prop:"codeName",minWidth:130},{label:"邮件ID",prop:"emailId",minWidth:130},{label:"长度",prop:"len",minWidth:130},{label:"通用码",prop:"universal",minWidth:130},{label:"重复次数",prop:"repe",minWidth:130},{label:"结束时间",prop:"endTime",minWidth:130,formatter:({endTime:a})=>X(a).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:180,slot:"operation"}],D=Q(()=>["!h-[20px]","reset-margin","!text-gray-500","dark:!text-white","dark:hover:!text-primary"]);function R(a){}function $(a){const e=[];for(const l in a){const s=a[l];e.push(s)}return e}function k(a){a&&(Number(a.universal)===0?L("【独码】",a):M("【通码】",a))}function L(a="【独码】",e){y({title:`${a}`,props:{formInline:{title:a,gameId:(i==null?void 0:i.gameId)??0,codeName:(e==null?void 0:e.codeName)??"",emailId:(e==null?void 0:e.emailId)??0,len:(e==null?void 0:e.len)??5,universal:(e==null?void 0:e.universal)??"0",repe:(e==null?void 0:e.repe)??1,isuse:(e==null?void 0:e.isuse)??0,endTime:(e==null?void 0:e.endTime)??"",id:(e==null?void 0:e.id)??0,quantity:(e==null?void 0:e.quantity)??0,mailList:m.value?m.value:[]}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>C(ee,{ref:f}),beforeSure:(l,{options:s})=>{const c=f.value.getRef(),n=s.props.formInline;function u(){if(n&&Number(n.quantity)<1){o(`您${a}生活激活码失败，由于生成数量为${n.quantity}`,{type:"warning"});return}o(`您${a}了激活码名为${n.codeName}的这条数据`,{type:"success"}),l()}c.validate(v=>{v&&(t.value=!0,H(n),u(),setTimeout(()=>{t.value=!1},500))})}})}function M(a="【通码】",e){y({title:`${a}激活码类型`,props:{formInline:{title:a,gameId:(i==null?void 0:i.gameId)??0,codeName:(e==null?void 0:e.codeName)??"",emailId:(e==null?void 0:e.emailId)??0,len:(e==null?void 0:e.len)??5,universal:(e==null?void 0:e.universal)??"0",repe:(e==null?void 0:e.repe)??1,isuse:(e==null?void 0:e.isuse)??0,endTime:(e==null?void 0:e.endTime)??"",id:(e==null?void 0:e.id)??0,code:(e==null?void 0:e.code)??"",mailList:m.value?m.value:[]}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>C(ae,{ref:f}),beforeSure:(l,{options:s})=>{const c=f.value.getRef(),n=s.props.formInline;function u(){o(`您${a}了激活码名为${n.codeName}的这条数据`,{type:"success"}),l()}c.validate(v=>{v&&(t.value=!0,j(n),u(),setTimeout(()=>{t.value=!1},500))})}})}function W(a="新增",e){y({title:`${a}激活码类型`,props:{formInline:{title:a,id:(e==null?void 0:e.id)??0,gameId:(i==null?void 0:i.gameId)??0,codeName:(e==null?void 0:e.codeName)??"",emailId:(e==null?void 0:e.emailId)??0,len:(e==null?void 0:e.len)??5,universal:(e==null?void 0:e.universal)??"0",repe:(e==null?void 0:e.repe)??1,isuse:(e==null?void 0:e.isuse)??0,endTime:(e==null?void 0:e.endTime)??"",mailList:m.value?m.value:[]}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>C(w,{ref:f}),beforeSure:(l,{options:s})=>{const c=f.value.getRef(),n=s.props.formInline;function u(){o(`您${a}了激活码名为${n.codeName}的这条数据`,{type:"success"}),l(),setTimeout(()=>{p()},500)}c.validate(v=>{v&&(a==="新增"?(te(n),u()):(ne(n),u()))})}})}const F=()=>{const a=h.value.map(c=>{const n=[];return I.forEach(u=>{n.push(c[u.prop])}),n}),e=[];I.forEach(c=>{e.push(c.label)}),a.unshift(e);const l=S.aoa_to_sheet(a),s=S.book_new();S.book_append_sheet(s,l,"数据报表"),oe(s,"activateCode-table.xlsx"),o("导出成功",{type:"success"})};function G(a){o(`您删除了激活码名为${a.codeName}的这条数据`,{type:"success"}),ie(a),setTimeout(()=>{t.value=!1,p()},500)}function q(a){}function Y(a){}function z(a){r.value=a.length,g.value.setAdaptive()}function A(){r.value=0,g.value.getTableRef().clearSelection()}function O(){const a=g.value.getTableRef().getSelectionRows();o(`已删除服务器为 ${Z(a,"codeName")} 的数据`,{type:"success"}),g.value.getTableRef().clearSelection()}async function E(){t.value=!0;const{data:a}=await de();T.value=a,setTimeout(()=>{t.value=!1,p()},500)}async function p(){t.value=!0;const{data:a}=await se(i);h.value=$(a),N.total=a.total?a.total:1,setTimeout(()=>{t.value=!1},500)}async function U(){t.value=!0;const{data:a}=await le();m.value=$(a),setTimeout(()=>{t.value=!1},500)}async function H(a){t.value=!0,await ce(a),setTimeout(()=>{t.value=!1},500)}async function j(a){t.value=!0,await ue(a),setTimeout(()=>{t.value=!1},500)}const B=a=>{a&&(a.resetFields(),p())};J(_,({newPwd:a})=>x.value=K(a)?-1:me(a).score);async function P(a){}return V(()=>{E(),p(),U()}),{form:i,loading:t,columns:I,dataList:h,gameDataList:T,pagination:N,buttonClass:D,selectedNum:r,onSearch:p,onAddGame:W,onGencode:k,onbatchDel:O,handleRole:P,resetForm:B,exportExcel:F,handleUpdate:R,handleDelete:G,handleSizeChange:q,onSelectionCancel:A,handleCurrentChange:Y,handleSelectionChange:z}}export{Te as useUser};
