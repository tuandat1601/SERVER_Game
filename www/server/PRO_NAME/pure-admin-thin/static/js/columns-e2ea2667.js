import{b as f}from"./data-eba8857e.js";import{k as a,aG as d}from"./index-bd88d923.js";const s=function(e,n){if(n=n||{},!(this instanceof s))return new s(e,n);this.conf={styleStr:"",setDomHeightArr:[],printBeforeFn:null,printDoneCallBack:null};for(const o in this.conf)o&&n.hasOwnProperty(o)&&(this.conf[o]=n[o]);typeof e=="string"?this.dom=document.querySelector(e):this.dom=this.isDOM(e)?e:e.$el,this.conf.setDomHeightArr&&this.conf.setDomHeightArr.length&&this.setDomHeight(this.conf.setDomHeightArr),this.init()};s.prototype={init:function(){const e=this.getStyle()+this.getHtml();this.writeIframe(e)},extendOptions:function(e,n){for(const o in n)e[o]=n[o];return e},getStyle:function(){let e="";const n=document.querySelectorAll("style,link");for(let o=0;o<n.length;o++)e+=n[o].outerHTML;return e+=`<style>.no-print{display:none;}${this.conf.styleStr}</style>`,e},getHtml:function(){const e=document.querySelectorAll("input"),n=document.querySelectorAll("select"),o=document.querySelectorAll("textarea"),i=document.querySelectorAll("canvas");for(let t=0;t<e.length;t++)e[t].type=="checkbox"||e[t].type=="radio"?e[t].checked==!0?e[t].setAttribute("checked","checked"):e[t].removeAttribute("checked"):(e[t].type=="text",e[t].setAttribute("value",e[t].value));for(let t=0;t<o.length;t++)o[t].type=="textarea"&&(o[t].innerHTML=o[t].value);for(let t=0;t<n.length;t++)if(n[t].type=="select-one"){const c=n[t].children;for(const r in c)c[r].tagName=="OPTION"&&(c[r].selected==!0?c[r].setAttribute("selected","selected"):c[r].removeAttribute("selected"))}for(let t=0;t<i.length;t++){const c=i[t].toDataURL("image/png"),r=document.createElement("img");r.src=c,r.setAttribute("style","max-width: 100%;"),r.className="isNeedRemove",i[t].parentNode.insertBefore(r,i[t].nextElementSibling)}return this.dom.outerHTML},writeIframe:function(e){let n,o;const i=document.createElement("iframe"),t=document.body.appendChild(i);i.id="myIframe",i.setAttribute("style","position:absolute;width:0;height:0;top:-10px;left:-10px;"),n=t.contentWindow||t.contentDocument,o=t.contentDocument||t.contentWindow.document,o.open(),o.write(e),o.close();const c=document.querySelectorAll(".isNeedRemove");for(let l=0;l<c.length;l++)c[l].parentNode.removeChild(c[l]);const r=this;i.onload=function(){r.conf.printBeforeFn&&r.conf.printBeforeFn({doc:o}),r.toPrint(n),setTimeout(function(){document.body.removeChild(i),r.conf.printDoneCallBack&&r.conf.printDoneCallBack()},100)}},toPrint:function(e){try{setTimeout(function(){e.focus();try{e.document.execCommand("print",!1,null)||e.print()}catch{e.print()}e.close()},10)}catch(n){console.error(n)}},isDOM:typeof HTMLElement=="object"?function(e){return e instanceof HTMLElement}:function(e){return e&&typeof e=="object"&&e.nodeType===1&&typeof e.nodeName=="string"},setDomHeight(e){e&&e.length&&e.forEach(n=>{document.querySelectorAll(n).forEach(i=>{i.style.height=i.offsetHeight+"px"})})}};function p(e){const n=a(d(f,!0)),o=[{label:"ID",prop:"id"},{label:"日期",prop:"date"},{label:"姓名",prop:"name"},{label:"地址",prop:"address"}],i=()=>{s(e.value.getTableDoms().tableWrapper).toPrint};function t({column:{property:l},rowIndex:u}){if(l==="id")return u<3?{background:"#87baf9"}:{background:"#87e8de"}}function c({columnIndex:l}){return l===0?{background:"#f3b2d0"}:{background:"#fafafa"}}function r({rowIndex:l}){return l%2===1?{background:"#ffa39e"}:{background:"#91d5ff"}}return{columns:o,dataList:n,print:i,rowStyle:r,cellStyle:t,headerCellStyle:c}}export{p as useColumns};
