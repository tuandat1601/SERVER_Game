import{Y as u,k as a,v as I,O as L,N,m as V,e as _,r as H,aU as O,aQ as j,ae as P,at as c,aR as Q}from"./index-bd88d923.js";import{_ as q}from"./index.vue_vue_type_script_setup_true_lang-566bdc03.js";import{c as B,u as E,d as h,g as G}from"./system-e8e4b1d8.js";import{z as J}from"./index.esm-cdf23848.js";import"./index-8426971e.js";import"./hooks-4c4a002a.js";function ne(s,K){const v=u({username:"",nickname:"",password:"",roles:[],auths:[],status:0,createdAt:""}),d=a(),m=a([]),l=a(!0),g=a({}),i=a(0),p=u({total:0,pageSize:10,currentPage:1,background:!0}),b=u({newPwd:""}),S=a();a([]);const x=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"用户名称",prop:"username",minWidth:130},{label:"用户昵称",prop:"nickname",minWidth:130},{label:"用户角色",prop:"roles",minWidth:130},{label:"用户权限",prop:"auths",minWidth:130},{label:"状态",prop:"status",minWidth:90,cellRenderer:e=>{var t;return _(H("el-switch"),{size:e.props.size==="small"?"small":"default",loading:(t=g.value[e.index])==null?void 0:t.loading,modelValue:e.row.status,"onUpdate:modelValue":o=>e.row.status=o,"active-value":1,"inactive-value":0,"active-text":"已开启","inactive-text":"已关闭","inline-prompt":!0},null)}},{label:"创建时间",minWidth:90,prop:"createdAt",formatter:({createdAt:e})=>O(e).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:180,slot:"operation"}],k=I(()=>["!h-[20px]","reset-margin","!text-gray-500","dark:!text-white","dark:hover:!text-primary"]);function y(e){}function D(e="新增",t){j({title:`${e}用户`,props:{formInline:{title:e,nickname:(t==null?void 0:t.nickname)??"",username:(t==null?void 0:t.username)??"",password:(t==null?void 0:t.password)??"",roles:(t==null?void 0:t.roles)??[],auths:(t==null?void 0:t.auths)??[],status:(t==null?void 0:t.status)??0}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>P(q,{ref:d}),beforeSure:(o,{options:Y})=>{const $=d.value.getRef(),r=Y.props.formInline;function f(){c(`您${e}了用户名称为${r.username}的这条数据`,{type:"success"}),o(),setTimeout(()=>{n()},500)}$.validate(A=>{A&&(e==="新增"?(B(r),f()):(E(r),f()))})}})}function R(e){c(`您删除了用户编号为${e.nickname}的这条数据`,{type:"success"}),h(e.username),n()}function U(e){}function C(e){}function F(e){i.value=e.length,s.value.setAdaptive()}function z(){i.value=0,s.value.getTableRef().clearSelection()}function M(){const e=s.value.getTableRef().getSelectionRows();for(let t=0;t<e.length;++t)h(e[t].username);c(`已删除用户编号为 ${Q(e,"id")} 的数据`,{type:"success"}),s.value.getTableRef().clearSelection()}async function n(){l.value=!0;const{data:e}=await G();m.value=e,p.total=e.total?e.total:0,setTimeout(()=>{l.value=!1},500)}const W=e=>{e&&(e.resetFields(),n())};L(b,({newPwd:e})=>S.value=N(e)?-1:J(e).score);async function T(e){}return V(()=>{n()}),{form:v,loading:l,columns:x,dataList:m,pagination:p,buttonClass:k,selectedNum:i,onSearch:n,onAddUser:D,onbatchDel:M,handleRole:T,resetForm:W,handleUpdate:y,handleDelete:R,handleSizeChange:U,onSelectionCancel:z,handleCurrentChange:C,handleSelectionChange:F}}export{ne as useUser};
