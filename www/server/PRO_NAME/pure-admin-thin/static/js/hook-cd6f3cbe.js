import{Y as v,k as n,v as y,b0 as P,O as Q,N as q,m as J,aU as g,aQ as K,at as u,aR as V}from"./index-bd88d923.js";import{a as X,g as Z}from"./game-c13a10d3.js";import{u as Y}from"./customerservice-4138c2d1.js";import{z as ee}from"./index.esm-cdf23848.js";import{u as b,w as te}from"./xlsx-f5126985.js";function le(l){const a=v({gameId:1,serverId:1,roles:"",status:0,chatStatus:0}),x=n(),m=n([]),I=n([]),S=n([]),C=n([]),s=n(!0),p=n(0),D=v({total:0,pageSize:10,currentPage:1,background:!0}),R=v({newPwd:""}),M=n();n([]);const h=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"序号",prop:"id",minWidth:130},{label:"服务器ID",prop:"serverId",minWidth:130},{label:"游戏ID",prop:"gameId",minWidth:130},{label:"BackendId",prop:"gameBackendUserId",minWidth:130},{label:"玩家ID",prop:"gameUserId",minWidth:130},{label:"游戏角色",prop:"gameRoleId",minWidth:130},{label:"角色名",prop:"gameRoleName",minWidth:130},{label:"商品ID",prop:"shopId",minWidth:130},{label:"价格",prop:"paidAmount",minWidth:130},{label:"付费",prop:"paid",minWidth:130},{label:"付费时间",prop:"paidTime",minWidth:130,formatter:({paidTime:e})=>g(e).format("YYYY-MM-DD HH:mm:ss")},{label:"delivered",prop:"delivered",minWidth:130},{label:"创建时间",prop:"createdAt",minWidth:130,formatter:({createdAt:e})=>g(e).format("YYYY-MM-DD HH:mm:ss")},{label:"更新时间",prop:"updatedAt",minWidth:130,formatter:({createdAt:e})=>g(e).format("YYYY-MM-DD HH:mm:ss")},{label:"svr游戏ID",prop:"serversGameId",minWidth:130},{label:"svr服务器ID",prop:"serversServerId",minWidth:130}],T=y(()=>["!h-[20px]","reset-margin","!text-gray-500","dark:!text-white","dark:hover:!text-primary"]);y(()=>{var e;return(e=P())==null?void 0:e.roles});function H(e){}function L(e="新增",t){K({title:`${e}通告`,props:{formInline:{title:e,name:(t==null?void 0:t.name)??"",rank:(t==null?void 0:t.rank)??0,dec:(t==null?void 0:t.dec)??""}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,beforeSure:(f,{options:i})=>{const r=x.value.getRef(),c=i.props.formInline;function d(){u(`您${e}了渠道名为${c.name}的这条数据`,{type:"success"}),f(),o()}r.validate(w=>{w&&d()})}})}const U=()=>{const e=m.value.map(r=>{const c=[];return h.forEach(d=>{c.push(r[d.prop])}),c}),t=[];h.forEach(r=>{t.push(r.label)}),e.unshift(t);const f=b.aoa_to_sheet(e),i=b.book_new();b.book_append_sheet(i,f,"数据报表"),te(i,"recharge-table.xlsx"),u("导出成功",{type:"success"})};function A(e=0){W(e)}function F(e){u(`您删除了渠道名为${e.name}的这条数据`,{type:"success"}),deleteChannel(e.id),k()}function G(e){o()}function _(e){o()}function $(e){p.value=e.length,l.value.setAdaptive()}function z(){p.value=0,l.value.getTableRef().clearSelection()}function B(){const e=l.value.getTableRef().getSelectionRows();u(`已删除服务器为 ${V(e,"id")} 的数据`,{type:"success"}),l.value.getTableRef().clearSelection()}async function o(){const e={gameid:a.gameId,serverid:a.serverId,roleId:a.roles,status:a.status},{data:t}=await Y(e);m.value=t.info,D.total=t.totalpages?t.totalpages:1,setTimeout(()=>{s.value=!1},500)}async function N(){const e={gameid:a.gameId,serverid:a.serverId,roleId:a.roles,status:a.chatStatus};await Y(e),setTimeout(()=>{s.value=!1},500)}async function E(){s.value=!0;const{data:e}=await X();I.value=e,setTimeout(()=>{s.value=!1,W(a.gameId)},300)}async function W(e){s.value=!0;const{data:t}=await Z(e);S.value=t,setTimeout(()=>{s.value=!1},500)}async function k(){}const O=e=>{e&&(e.resetFields(),o())};Q(R,({newPwd:e})=>M.value=q(e)?-1:ee(e).score);async function j(e){}return J(()=>{E()}),{form:a,loading:s,columns:h,dataList:m,gameDataList:I,sverDataList:S,channelDataList:C,pagination:D,buttonClass:T,selectedNum:p,onSearch:k,onAddGame:L,exportExcel:U,onbatchDel:B,handleRole:j,resetForm:O,handleUpdate:H,handleDelete:F,onRechargeSearch:o,onChargeChatStatus:N,onSelectionGame:A,handleSizeChange:G,onSelectionCancel:z,handleCurrentChange:_,handleSelectionChange:$}}export{le as useUser};
