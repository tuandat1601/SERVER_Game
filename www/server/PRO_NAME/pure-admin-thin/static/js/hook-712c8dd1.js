import{Y as I,k as u,v as P,O as Q,N as Y,m as q,aQ as B,ae as H,G as o,at as y,aR as J}from"./index-bd88d923.js";import{_ as V}from"./index.vue_vue_type_script_setup_true_lang-50c5106a.js";import{F as b,a as X}from"./game-c13a10d3.js";import{z as Z}from"./index.esm-cdf23848.js";import"./index-8426971e.js";import"./hooks-142968e5.js";let U;function ce(d){const g=I({gameUrl:"",gameId:1}),S=u(),x=u([]),r=u([]),p=u(!0),h=u(0),_=I({total:0,pageSize:10,currentPage:1,background:!0}),C=I({newPwd:""}),T=u();u([]);const R=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"游戏URL",prop:"gameUrl",minWidth:130},{label:"游戏urlInfo",prop:"urlInfo",minWidth:130},{label:"操作",fixed:"right",width:180,slot:"operation"}],k=P(()=>["!h-[20px]","reset-margin","!text-gray-500","dark:!text-white","dark:hover:!text-primary"]);function G(n){}function A(n="新增",e){B({title:`${n}游戏URL`,props:{formInline:{title:n,channelAppId:(e==null?void 0:e.channelAppId)??0,channelType:(e==null?void 0:e.channelType)??"",appName:(e==null?void 0:e.appName)??0,appId:(e==null?void 0:e.appId)??"",appKey:(e==null?void 0:e.appKey)??"",serverKey:(e==null?void 0:e.serverKey)??"",notice:(e==null?void 0:e.notice)??[],user_policy_url:(e==null?void 0:e.user_policy_url)??"",privacy_policy_url:(e==null?void 0:e.privacy_policy_url)??"",payMentSwitch:(e==null?void 0:e.payMentSwitch)??!0,gameUrl:(e==null?void 0:e.gameUrl)??[]}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>H(V,{ref:S}),beforeSure:(t,{options:a})=>{const l=S.value.getRef(),c=a.props.formInline;function i(){y(`您${n}了渠道名为${c.appName}的这条数据`,{type:"success"}),t(),m(),s()}l.validate(f=>{f&&(n==="新增"?(D(c),i()):(e.channelAppId,i()))})}})}function v(n,e){for(let t=0;t<e.length;t++){const a=e[t];if(n===a.id)return t}return 0}function D(n){const e=o(U),t={gameUrl:n.gameUrl},a=v(g.gameId,e),l=String(t.gameUrl).split(","),i=o(e[a].gameUrl).concat(l);e[a].gameUrl=o(i),e[a].info||(e[a].info={}),e[a].info.urlInfo||(e[a].info.urlInfo={});const f={};f.gamedbUrl=n.urlInfo,e[a].info.urlInfo[n.gameUrl]=f,b(e[a]),setTimeout(()=>{m(),s()},800)}function E(n,e){}function F(n){const e=o(U),t=v(g.gameId,e),a=e[t].gameUrl;for(let l=0;l<a.length;l++)if(a[l]===n){a.splice(l,1);break}e[t].gameUrl=o(a),b(e[t]),setTimeout(()=>{m(),s()},800)}function L(n){y(`您删除了渠道名为${n.name}的这条数据`,{type:"success"}),F(n.gameUrl),m(),s()}function M(n){}function N(n){}function $(n){h.value=n.length,d.value.setAdaptive()}function z(){h.value=0,d.value.getTableRef().clearSelection()}function K(){const n=d.value.getTableRef().getSelectionRows();y(`已删除服务器为 ${J(n,"id")} 的数据`,{type:"success"}),d.value.getTableRef().clearSelection()}async function s(){p.value=!0;const n=v(g.gameId,r.value),e=r.value[n].gameUrl,t=[];for(let a=0;a<e.length;a++){const l=e[a],c={};c.gameUrl=e[a],c.urlInfo="";for(const i in r.value[n].info.urlInfo)if(i===l){const f=r.value[n].info.urlInfo[i];c.urlInfo=f.gamedbUrl}t.push(c)}x.value=o(t),setTimeout(()=>{p.value=!1},500)}async function m(){p.value=!0;const{data:n}=await X();U=o(n),r.value=n,setTimeout(()=>{p.value=!1},500)}async function j(){}const O=n=>{n&&(n.resetFields(),m(),s())};Q(C,({newPwd:n})=>T.value=Y(n)?-1:Z(n).score);async function W(n){}return q(()=>{m(),setTimeout(()=>{s()},500)}),{form:g,loading:p,columns:R,dataList:x,gameDataList:r,pagination:_,buttonClass:k,selectedNum:h,onSearch:j,onAddGame:A,onbatchDel:K,handleRole:W,resetForm:O,onChannelSearch:s,handleUpdate:G,handleDelete:L,handleSizeChange:M,onSelectionCancel:z,handleCurrentChange:N,handleSelectionChange:$}}export{ce as useUser};
