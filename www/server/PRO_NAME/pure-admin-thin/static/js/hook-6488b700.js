import{Y as S,k as o,v as E,O as H,N as P,m as q,e as B,r as Q,aU as J,aQ as K,ae as X,at as m,aR as Z,bd as w}from"./index-bd88d923.js";import{_ as ee}from"./index.vue_vue_type_script_setup_true_lang-17b6e1e0.js";import{b as ae,u as te,c as ne,i as ie,e as se,h as le}from"./operations-67cacc8a.js";import{a as oe}from"./game-c13a10d3.js";import{z as re}from"./index.esm-cdf23848.js";import{u as y,w as ue}from"./xlsx-f5126985.js";import"./index-8426971e.js";import"./hooks-6a2b754a.js";function de(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Object]"&&!w(r)}function Se(r){const n=S({id:0,gameId:1,quantity:0,type:2,cinfoid:0,codeName:"string",emailId:0,len:0,universal:0,repe:0,isuse:0,endTime:"string",pagesize:0,page:0}),N=o(),f=o([]),C=o([]),I=o([]),s=o(!0),t=o("nohide"),v=o(0),p=S({total:0,pageSize:10,currentPage:1,background:!0}),T=S({newPwd:""}),D=o();o([]);const g=[{label:"勾选列",type:"selection",fixed:"left",hide:()=>t.value==="hideAll"||t.value==="hideNoOrder",reserveSelection:!0},{label:"激活码ID",prop:"id",minWidth:130,hide:()=>t.value==="hideAll"},{label:"激活码infoId",prop:"codeinfoId",minWidth:130,hide:()=>t.value==="hideAll"||t.value==="hideNoOrder"},{label:"角色ID",prop:"roleId",minWidth:130,hide:()=>t.value==="hideAll"||t.value==="hideNoOrder"},{label:"激活编码",prop:"code",minWidth:130},{label:"使用",prop:"used",minWidth:130,cellRenderer:({row:e,props:a})=>{let l;return B(Q("el-tag"),{size:a.size},de(l=k(e.used))?l:{default:()=>[l]})},hide:()=>t.value==="hideAll"||t.value==="hideNoOrder"},{label:"激活时间",prop:"actTime",minWidth:130,formatter:({actTime:e})=>J(e).format("YYYY-MM-DD HH:mm:ss"),hide:()=>t.value==="hideAll"||t.value==="hideNoOrder"}],O=E(()=>["!h-[20px]","reset-margin","!text-gray-500","dark:!text-white","dark:hover:!text-primary"]);function k(e){return e===0?"未使用":e===1?"已使用":e===3?"通码":e}function z(e){}function b(e){const a=[];for(const l in e){const c=e[l];a.push(c)}return a}function _(e="新增",a){K({title:`${e}激活码`,props:{formInline:{title:e,gameId:(n==null?void 0:n.gameId)??0,codeName:(a==null?void 0:a.codeName)??"",emailId:(a==null?void 0:a.emailId)??0,len:(a==null?void 0:a.len)??0,universal:(a==null?void 0:a.universal)??0,repe:(a==null?void 0:a.repe)??0,isuse:(a==null?void 0:a.isuse)??0,endTime:(a==null?void 0:a.endTime)??""}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>X(ee,{ref:N}),beforeSure:(l,{options:c})=>{const i=N.value.getRef(),u=c.props.formInline;function d(){m(`您${e}了激活码名为${u.codeName}的这条数据`,{type:"success"}),l(),h()}i.validate(V=>{V&&(e==="新增"?(ae(u),d()):(te(u),d()))})}})}const A=()=>{const e=f.value.map(i=>{const u=[];return g.forEach(d=>{t.value==="nohide"?u.push(i[d.prop]):d.hide?t.value==="hideNoOrder"&&d.prop==="id"&&u.push(i[d.prop]):u.push(i[d.prop])}),u}),a=[];g.forEach(i=>{t.value==="nohide"?a.push(i.label):i.hide?t.value==="hideNoOrder"&&i.prop==="id"&&a.push(i.label):a.push(i.label)}),e.unshift(a);const l=y.aoa_to_sheet(e),c=y.book_new();y.book_append_sheet(c,l,"数据报表"),ue(c,"activateCode-table.xlsx"),m("导出成功",{type:"success"})};function R(e){m(`您删除了激活码名为${e.codeName}的这条数据`,{type:"success"}),ne(e),h()}function L(e){}function W(e){}function F(e){v.value=e.length,r.value.setAdaptive()}function M(){v.value=0,r.value.getTableRef().clearSelection()}function Y(){const e=r.value.getTableRef().getSelectionRows();m(`已删除服务器为 ${Z(e,"codeName")} 的数据`,{type:"success"}),r.value.getTableRef().clearSelection()}async function $(){s.value=!0;const{data:e}=await oe();I.value=e,setTimeout(()=>{s.value=!1,x()},500)}async function h(){s.value=!0,Number(n.page)===0&&(n.page=p.currentPage),Number(n.pagesize)===0&&(n.pagesize=p.pageSize);const{data:e}=await ie(n);f.value=b(e),p.total=e.count?e.count:20,setTimeout(()=>{s.value=!1},500)}async function x(){s.value=!0;const{data:e}=await se(n);C.value=b(e),setTimeout(()=>{s.value=!1},500)}async function j(){s.value=!0;const{data:e}=await le(n);f.value=b(e),p.total=e.total?e.total:1,setTimeout(()=>{s.value=!1},500)}const G=e=>{e&&(e.resetFields(),h())};H(T,({newPwd:e})=>D.value=P(e)?-1:re(e).score);async function U(e){}return q(()=>{$()}),{form:n,hideVal:t,loading:s,columns:g,dataList:f,gameDataList:I,activeDataList:C,pagination:p,buttonClass:O,selectedNum:v,onSearch:h,onGencode:j,onAddGame:_,onbatchDel:Y,handleRole:U,resetForm:G,exportExcel:A,handleUpdate:z,handleDelete:R,onActiveTypeSearch:x,handleSizeChange:L,onSelectionCancel:M,handleCurrentChange:W,handleSelectionChange:F}}export{Se as useUser};
