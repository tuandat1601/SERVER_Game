import{Y as b,k as n,v as H,O,N as j,m as q,aU as B,aQ as P,ae as Q,at as p,aR as J}from"./index-bd88d923.js";import{_ as K}from"./index.vue_vue_type_script_setup_true_lang-171bde94.js";import{b as V,u as X,c as Z,o as w,e as ee,f as te}from"./operations-67cacc8a.js";import{a as ae}from"./game-c13a10d3.js";import{z as ne}from"./index.esm-cdf23848.js";import{u as y,w as se}from"./xlsx-f5126985.js";import"./index-8426971e.js";import"./hooks-6a2b754a.js";function pe(u){const s=b({id:0,gameId:1,quantity:"",type:2,codeName:"string",emailId:0,len:0,universal:0,repe:0,isuse:0,endTime:"string"}),S=n(),r=n([]),C=n([]),I=n([]),a=n(!0),f=n(0),h=b({total:0,pageSize:10,currentPage:1,background:!0}),x=b({newPwd:""}),T=n();n([]);const v=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"激活码ID",prop:"id",minWidth:130},{label:"激活码infoId",prop:"codeinfoId",minWidth:130},{label:"角色ID",prop:"roleId",minWidth:130},{label:"激活编码",prop:"code",minWidth:130},{label:"使用",prop:"used",minWidth:130},{label:"激活时间",prop:"actTime",minWidth:130,formatter:({actTime:e})=>B(e).format("YYYY-MM-DD HH:mm:ss")}],D=H(()=>["!h-[20px]","reset-margin","!text-gray-500","dark:!text-white","dark:hover:!text-primary"]);function k(e){}function g(e){const t=[];for(const i in e){const o=e[i];t.push(o)}return t}function N(e="新增",t){P({title:`${e}激活码`,props:{formInline:{title:e,gameId:(s==null?void 0:s.gameId)??0,codeName:(t==null?void 0:t.codeName)??"",emailId:(t==null?void 0:t.emailId)??0,len:(t==null?void 0:t.len)??0,universal:(t==null?void 0:t.universal)??0,repe:(t==null?void 0:t.repe)??0,isuse:(t==null?void 0:t.isuse)??0,endTime:(t==null?void 0:t.endTime)??""}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>Q(K,{ref:S}),beforeSure:(i,{options:o})=>{const l=S.value.getRef(),c=o.props.formInline;function m(){p(`您${e}了激活码名为${c.codeName}的这条数据`,{type:"success"}),i(),d()}l.validate(E=>{E&&(e==="新增"?(V(c),m()):(X(c),m()))})}})}const _=()=>{const e=r.value.map(l=>{const c=[];return v.forEach(m=>{c.push(l[m.prop])}),c}),t=[];v.forEach(l=>{t.push(l.label)}),e.unshift(t);const i=y.aoa_to_sheet(e),o=y.book_new();y.book_append_sheet(o,i,"数据报表"),se(o,"activateCode-table.xlsx"),p("导出成功",{type:"success"})};function R(e){p(`您删除了激活码名为${e.codeName}的这条数据`,{type:"success"}),Z(e),d()}function L(e){}function W(e){}function F(e){f.value=e.length,u.value.setAdaptive()}function M(){f.value=0,u.value.getTableRef().clearSelection()}function Y(){const e=u.value.getTableRef().getSelectionRows();p(`已删除服务器为 ${J(e,"codeName")} 的数据`,{type:"success"}),u.value.getTableRef().clearSelection()}async function $(){a.value=!0;const{data:e}=await ae();I.value=e,setTimeout(()=>{a.value=!1},500)}async function d(){a.value=!0;const{data:e}=await w(s);r.value=g(e),h.total=e.total?e.total:1,setTimeout(()=>{a.value=!1},500)}async function z(){a.value=!0;const{data:e}=await ee(s);C.value=g(e),setTimeout(()=>{a.value=!1},500)}async function G(){a.value=!0;const{data:e}=await te(s);r.value=g(e),h.total=e.total?e.total:1,setTimeout(()=>{a.value=!1},500)}const A=e=>{e&&(e.resetFields(),d())};O(x,({newPwd:e})=>T.value=j(e)?-1:ne(e).score);async function U(e){}return q(()=>{$()}),{form:s,loading:a,columns:v,dataList:r,gameDataList:I,activeDataList:C,pagination:h,buttonClass:D,selectedNum:f,onSearch:d,onGencode:G,onAddGame:N,onbatchDel:Y,handleRole:U,resetForm:A,exportExcel:_,handleUpdate:k,handleDelete:R,onActiveTypeSearch:z,handleSizeChange:L,onSelectionCancel:M,handleCurrentChange:W,handleSelectionChange:F}}export{pe as useUser};
