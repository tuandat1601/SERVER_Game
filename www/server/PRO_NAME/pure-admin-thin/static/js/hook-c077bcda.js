import{Y as v,k as l,v as P,O as Q,N as W,m as Y,aQ as q,ae as H,G as s,at as b,aR as J}from"./index-bd88d923.js";import{_ as V}from"./index.vue_vue_type_script_setup_true_lang-63b51218.js";import{u as x,a as X}from"./game-c13a10d3.js";import{z as Z}from"./index.esm-cdf23848.js";import"./index-8426971e.js";import"./hooks-142968e5.js";let y;function le(r){const d=v({blacklist:"",gameId:1}),k=l(),S=l([]),f=l([]),u=l(!0),h=l(0),I=v({total:0,pageSize:10,currentPage:1,background:!0}),_=v({newPwd:""}),C=l();l([]);const T=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"黑名单",prop:"blacklist",minWidth:130},{label:"操作",fixed:"right",width:180,slot:"operation"}],D=P(()=>["!h-[20px]","reset-margin","!text-gray-500","dark:!text-white","dark:hover:!text-primary"]);function R(t){}function A(t="新增",e){q({title:`${t}黑名单`,props:{formInline:{title:t,channelAppId:(e==null?void 0:e.channelAppId)??0,channelType:(e==null?void 0:e.channelType)??"",appName:(e==null?void 0:e.appName)??0,appId:(e==null?void 0:e.appId)??"",appKey:(e==null?void 0:e.appKey)??"",serverKey:(e==null?void 0:e.serverKey)??"",notice:(e==null?void 0:e.notice)??[],user_policy_url:(e==null?void 0:e.user_policy_url)??"",privacy_policy_url:(e==null?void 0:e.privacy_policy_url)??"",payMentSwitch:(e==null?void 0:e.payMentSwitch)??!0,blacklist:(e==null?void 0:e.blacklist)??[]}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>H(V,{ref:k}),beforeSure:(n,{options:a})=>{const c=k.value.getRef(),p=a.props.formInline;function m(){b(`您${t}了渠道名为${p.appName}的这条数据`,{type:"success"}),n(),i(),o()}c.validate(j=>{j&&(t==="新增"?(G(p),m()):(e.channelAppId,m()))})}})}function g(t,e){for(let n=0;n<e.length;n++){const a=e[n];if(t===a.id)return n}return 0}function G(t){const e=s(y),n={blacklist:t.blacklist},a=g(d.gameId,e),c=String(n.blacklist).split(","),m=s(e[a].blacklist).concat(c);e[a].blacklist=s(m),x(e[a]),i()}function E(t,e){}function M(t){const e=s(y),n=g(d.gameId,e),a=e[n].blacklist;for(let c=0;c<a.length;c++)if(a[c]===t){a.splice(c,1);break}e[n].blacklist=s(a),x(e[n]),i()}function N(t){b(`您删除了渠道名为${t.name}的这条数据`,{type:"success"}),M(t.blacklist),i(),o()}function $(t){}function z(t){}function F(t){h.value=t.length,r.value.setAdaptive()}function K(){h.value=0,r.value.getTableRef().clearSelection()}function L(){const t=r.value.getTableRef().getSelectionRows();b(`已删除服务器为 ${J(t,"id")} 的数据`,{type:"success"}),r.value.getTableRef().clearSelection()}async function o(){u.value=!0;const t=g(d.gameId,f.value),e=f.value[t].blacklist,n=[];for(let a=0;a<e.length;a++){e[a];const c={};c.blacklist=e[a],n.push(c)}S.value=s(n),setTimeout(()=>{u.value=!1},500)}async function i(){u.value=!0;const{data:t}=await X();y=s(t),f.value=t,setTimeout(()=>{u.value=!1},500)}async function B(){}const O=t=>{t&&(t.resetFields(),i(),o())};Q(_,({newPwd:t})=>C.value=W(t)?-1:Z(t).score);async function U(t){}return Y(()=>{i(),setTimeout(()=>{o()},500)}),{form:d,loading:u,columns:T,dataList:S,gameDataList:f,pagination:I,buttonClass:D,selectedNum:h,onSearch:B,onAddGame:A,onbatchDel:L,handleRole:U,resetForm:O,onChannelSearch:o,handleUpdate:R,handleDelete:N,handleSizeChange:$,onSelectionCancel:K,handleCurrentChange:z,handleSelectionChange:F}}export{le as useUser};
