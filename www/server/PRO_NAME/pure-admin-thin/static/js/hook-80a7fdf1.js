import{Y as u,k as a,v as Z,O as G,N as U,m as B,aU as y,aQ as E,ae as N,at as d,aR as O}from"./index-bd88d923.js";import{_ as P}from"./index.vue_vue_type_script_setup_true_lang-8f047ed3.js";import{H as j,I as J,J as Q,a as q,B as K}from"./game-c13a10d3.js";import{z as V}from"./index.esm-cdf23848.js";import{u as g,w as X}from"./xlsx-f5126985.js";import"./index-8426971e.js";import"./hooks-142968e5.js";function ce(i){const v=u({id:0,name:"",gameId:1,createdAt:"",updatedAt:""}),b=a(),m=a([]),S=a([]),s=a(!0),p=a(0),x=u({total:0,pageSize:10,currentPage:1,background:!0}),k=u({newPwd:""});u({newPwd:"status"});const A=a();a([]);const f=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"战区序号",prop:"id",minWidth:130},{label:"战区名",prop:"name",minWidth:130},{label:"战区序号",prop:"gameId",minWidth:130},{label:"创建时间",prop:"createdAt",minWidth:130,formatter:({createdAt:e})=>y(e).format("YYYY-MM-DD HH:mm:ss")},{label:"更新时间",prop:"updatedAt",minWidth:130,formatter:({updatedAt:e})=>y(e).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:180,slot:"operation"}],D=Z(()=>["!h-[20px]","reset-margin","!text-gray-500","dark:!text-white","dark:hover:!text-primary"]);function Y(e){}function I(e="新增",t){E({title:`${e}战区`,props:{formInline:{title:e,id:(t==null?void 0:t.id)??0,name:(t==null?void 0:t.name)??0,gameId:(t==null?void 0:t.gameId)??0,createdAt:(t==null?void 0:t.createdAt)??0,updatedAt:(t==null?void 0:t.updatedAt)??0}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>N(P,{ref:b}),beforeSure:(h,{options:l})=>{const c=b.value.getRef(),n=l.props.formInline;function r(){d(`您${e}了战区序号为${n.id}的这条数据`,{type:"success"}),h(),o()}c.validate($=>{$&&(e==="新增"?(j(n),r()):(J(n),r()))})}})}const _=()=>{const e=m.value.map(c=>{const n=[];return f.forEach(r=>{n.push(c[r.prop])}),n}),t=[];f.forEach(c=>{t.push(c.label)}),e.unshift(t);const h=g.aoa_to_sheet(e),l=g.book_new();g.book_append_sheet(l,h,"数据报表"),X(l,"zone-table.xlsx"),d("导出成功",{type:"success"})};function C(e){d(`您删除了战区序号为${e.id}的这条数据`,{type:"success"}),Q(e.id),o()}function M(e){}function R(e){}function z(e){p.value=e.length,i.value.setAdaptive()}function F(){p.value=0,i.value.getTableRef().clearSelection()}function H(){const e=i.value.getTableRef().getSelectionRows();d(`已删除服务器为 ${O(e,"id")} 的数据`,{type:"success"}),i.value.getTableRef().clearSelection()}async function L(){s.value=!0;const{data:e}=await q();S.value=e,setTimeout(()=>{s.value=!1},500)}async function o(){s.value=!0;const{data:e}=await K(v);m.value=e,x.total=e.total?e.total:0,setTimeout(()=>{s.value=!1},500)}const T=e=>{e&&(e.resetFields(),o())};G(k,({newPwd:e})=>A.value=U(e)?-1:V(e).score);async function W(e){}return B(()=>{L(),o()}),{form:v,loading:s,columns:f,dataList:m,gameDataList:S,pagination:x,buttonClass:D,selectedNum:p,onSearch:o,onAddGame:I,exportExcel:_,onbatchDel:H,handleRole:W,resetForm:T,handleUpdate:Y,handleDelete:C,handleSizeChange:M,onSelectionCancel:F,handleCurrentChange:R,handleSelectionChange:z}}export{ce as useUser};
