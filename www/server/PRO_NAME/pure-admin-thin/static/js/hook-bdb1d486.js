import{Y as v,k as c,v as P,O as Q,N as Y,m as q,aQ as B,ae as H,G as s,at as y,aR as J}from"./index-bd88d923.js";import{_ as V}from"./index.vue_vue_type_script_setup_true_lang-4d321a9f.js";import{G as b,a as X}from"./game-c13a10d3.js";import{z as Z}from"./index.esm-cdf23848.js";import"./index-8426971e.js";import"./hooks-142968e5.js";let S;function ce(r){const d=v({whitelist:"",gameId:1}),x=c(),I=c([]),h=c([]),u=c(!0),m=c(0),_=v({total:0,pageSize:10,currentPage:1,background:!0}),C=v({newPwd:""}),T=c();c([]);const D=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"白名单",prop:"whitelist",minWidth:130},{label:"操作",fixed:"right",width:180,slot:"operation"}],R=P(()=>["!h-[20px]","reset-margin","!text-gray-500","dark:!text-white","dark:hover:!text-primary"]);function k(t){}function A(t="新增",e){B({title:`${t}白名单`,props:{formInline:{title:t,channelAppId:(e==null?void 0:e.channelAppId)??0,channelType:(e==null?void 0:e.channelType)??"",appName:(e==null?void 0:e.appName)??0,appId:(e==null?void 0:e.appId)??"",appKey:(e==null?void 0:e.appKey)??"",serverKey:(e==null?void 0:e.serverKey)??"",notice:(e==null?void 0:e.notice)??[],user_policy_url:(e==null?void 0:e.user_policy_url)??"",privacy_policy_url:(e==null?void 0:e.privacy_policy_url)??"",payMentSwitch:(e==null?void 0:e.payMentSwitch)??!0,whitelist:(e==null?void 0:e.whitelist)??[]}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>H(V,{ref:x}),beforeSure:(a,{options:n})=>{const i=x.value.getRef(),p=n.props.formInline;function f(){y(`您${t}了渠道名为${p.appName}的这条数据`,{type:"success"}),a(),l(),o()}i.validate(j=>{j&&(t==="新增"?(G(p),f()):(e.channelAppId,f()))})}})}function g(t,e){for(let a=0;a<e.length;a++){const n=e[a];if(t===n.id)return a}return 0}function G(t){const e=s(S),a={whitelist:t.whitelist},n=g(d.gameId,e),i=String(a.whitelist).split(","),f=s(e[n].whitelist).concat(i);e[n].whitelist=s(f),b(e[n]),l()}function E(t,e){}function M(t){const e=s(S),a=g(d.gameId,e),n=e[a].whitelist;for(let i=0;i<n.length;i++)if(n[i]===t){n.splice(i,1);break}e[a].whitelist=s(n),b(e[a]),l()}function N(t){y(`您删除了渠道名为${t.name}的这条数据`,{type:"success"}),M(t.whitelist),l(),o()}function $(t){}function z(t){}function F(t){m.value=t.length,r.value.setAdaptive()}function K(){m.value=0,r.value.getTableRef().clearSelection()}function L(){const t=r.value.getTableRef().getSelectionRows();y(`已删除服务器为 ${J(t,"id")} 的数据`,{type:"success"}),r.value.getTableRef().clearSelection()}async function o(){u.value=!0;const t=g(d.gameId,h.value),e=h.value[t].whitelist,a=[];for(let n=0;n<e.length;n++){e[n];const i={};i.whitelist=e[n],a.push(i)}I.value=s(a),setTimeout(()=>{u.value=!1},500)}async function l(){u.value=!0;const{data:t}=await X();S=s(t),h.value=t,setTimeout(()=>{u.value=!1},500)}async function W(){}const O=t=>{t&&(t.resetFields(),l(),o())};Q(C,({newPwd:t})=>T.value=Y(t)?-1:Z(t).score);async function U(t){}return q(()=>{l(),setTimeout(()=>{o()},500)}),{form:d,loading:u,columns:D,dataList:I,gameDataList:h,pagination:_,buttonClass:R,selectedNum:m,onSearch:W,onAddGame:A,onbatchDel:L,handleRole:U,resetForm:O,onChannelSearch:o,handleUpdate:k,handleDelete:N,handleSizeChange:$,onSelectionCancel:K,handleCurrentChange:z,handleSelectionChange:F}}export{ce as useUser};
