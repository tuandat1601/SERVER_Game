import{Y as m,k as a,v as B,O as P,N as Q,m as Y,aQ as q,ae as H,at as v,aR as J,G as S}from"./index-bd88d923.js";import{_ as V}from"./index.vue_vue_type_script_setup_true_lang-1302d7fe.js";import{i as X,a as Z,j as E}from"./game-c13a10d3.js";import{z as w}from"./index.esm-cdf23848.js";import"./index-8426971e.js";import"./hooks-142968e5.js";function le(u){const r=m({id:0,url:"",gameId:1}),h=a(),i=a([]),d=a([]),l=a(!0),o=a(0),y=m({total:0,pageSize:10,currentPage:1,background:!0}),I=m({newPwd:""}),C=a();a([]);const b=[{label:"勾选列",type:"selection",fixed:"left",reserveSelection:!0},{label:"跨服id",prop:"id",minWidth:130},{label:"跨服URL",prop:"url",minWidth:130},{label:"操作",fixed:"right",width:180,slot:"operation"}],x=B(()=>["!h-[20px]","reset-margin","!text-gray-500","dark:!text-white","dark:hover:!text-primary"]);function _(t){}function T(t="新增",e){q({title:`${t}跨服服务器`,props:{formInline:{title:t,id:(e==null?void 0:e.id)??D(),channelAppId:(e==null?void 0:e.channelAppId)??0,channelType:(e==null?void 0:e.channelType)??"",appName:(e==null?void 0:e.appName)??0,appId:(e==null?void 0:e.appId)??"",appKey:(e==null?void 0:e.appKey)??"",serverKey:(e==null?void 0:e.serverKey)??"",notice:(e==null?void 0:e.notice)??[],user_policy_url:(e==null?void 0:e.user_policy_url)??"",privacy_policy_url:(e==null?void 0:e.privacy_policy_url)??"",payMentSwitch:(e==null?void 0:e.payMentSwitch)??!0,crossServer:(e==null?void 0:e.crossServer)??[]}},width:"46%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>H(V,{ref:h}),beforeSure:(c,{options:p})=>{const O=h.value.getRef(),f=p.props.formInline;function g(){v(`您${t}了渠道名为${f.appName}的这条数据`,{type:"success"}),c(),s(),n()}O.validate(W=>{W&&(t==="新增"?(k(f),g()):(e.channelAppId,g()))})}})}function R(t,e){for(let c=0;c<e.length;c++){const p=e[c];if(t===p.id)return c}return 0}function N(t){return t&&t.crossServer?t.crossServer:[]}function D(){return i.value.length>0?Number(i.value[i.value.length-1].id)+1:1}function k(t){const e={};e.gameId=r.gameId,e.crossUrl=t.url,e.crossServerId=t.id,X(e),setTimeout(()=>{s(),n()},1e3)}function ee(t,e){}function A(t){const e={};e.gameId=r.gameId,e.crossUrl=t.url,e.crossServerId=t.id,E(e),setTimeout(()=>{s(),n()},1e3)}function G(t){v(`您删除了跨服id为${t.id}的这条数据`,{type:"success"}),A(t),s(),n()}function L(t){}function M(t){}function U(t){o.value=t.length,u.value.setAdaptive()}function $(){o.value=0,u.value.getTableRef().clearSelection()}function z(){const t=u.value.getTableRef().getSelectionRows();v(`已删除服务器为 ${J(t,"id")} 的数据`,{type:"success"}),u.value.getTableRef().clearSelection()}async function n(){l.value=!0;const t=R(r.gameId,d.value),e=N(d.value[t].info);i.value=S(e),setTimeout(()=>{l.value=!1},500)}async function s(){l.value=!0;const{data:t}=await Z();S(t),d.value=t,setTimeout(()=>{l.value=!1},500)}async function F(){}const K=t=>{t&&(t.resetFields(),s(),n())};P(I,({newPwd:t})=>C.value=Q(t)?-1:w(t).score);async function j(t){}return Y(()=>{s(),setTimeout(()=>{n()},500)}),{form:r,loading:l,columns:b,dataList:i,gameDataList:d,pagination:y,buttonClass:x,selectedNum:o,onSearch:F,onAddGame:T,onbatchDel:z,handleRole:j,resetForm:K,onChannelSearch:n,handleUpdate:_,handleDelete:G,handleSizeChange:L,onSelectionCancel:$,handleCurrentChange:M,handleSelectionChange:U}}export{le as useUser};
